# 要件文書

## 概要

30代男性をターゲットとしたヘルスレコーディングアプリ。レコーディングダイエットの考え方に基づき、継続的な記録により健康の維持・管理向上を目指す。HealthKitとの連携により自動データ収集を実現し、手間を最小限に抑えたUI/UXで長期的なトレンド分析とリッチな可視化を提供する。

## 要件

### 要件1：データ自動収集

**ユーザーストーリー:** ユーザーとして、手動入力の手間を最小限に抑えて健康データを記録したいので、HealthKit経由で自動的にデータを収集できる機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーがアプリを初回起動する THEN システムは HealthKitへのアクセス許可を求める
2. WHEN HealthKitアクセスが許可される THEN システムは 体重、歩数、消費カロリーデータを自動収集する
3. WHEN 外部アプリ（スマート体重計アプリ、Apple Watchなど）がHealthKitにデータを送信する THEN システムは そのデータを自動的に取得・蓄積する
4. IF HealthKit経由でデータが取得できない THEN システムは 手動入力オプションを提供する

### 要件2：長期トレンド可視化

**ユーザーストーリー:** ユーザーとして、短期的な変動に惑わされず長期的な健康トレンドを把握したいので、リッチなデータ可視化機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーがダッシュボードを表示する THEN システムは 週次、月次、年次のトレンドグラフを表示する
2. WHEN データが7日以上蓄積される THEN システムは 移動平均線を含むトレンド分析を表示する
3. WHEN ユーザーが特定の期間を選択する THEN システムは その期間のデータ傾向と統計情報を表示する
4. WHEN 複数の健康指標がある THEN システムは 相関関係を視覚的に表示する

### 要件3：SNS共有機能

**ユーザーストーリー:** ユーザーとして、日々の頑張りを可視化・共有してモチベーションを維持したいので、リッチな見た目のSNS共有機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーが共有ボタンをタップする THEN システムは 美しくデザインされた成果画像を生成する
2. WHEN 共有画像が生成される THEN システムは ユーザーの達成状況、トレンド、励ましメッセージを含める
3. WHEN ユーザーが共有先を選択する THEN システムは Twitter、Instagram、LINEなどの主要SNSに対応する
4. IF ユーザーが週次・月次目標を達成する THEN システムは 特別な達成バッジ付きの共有画像を生成する

### 要件4：継続促進機能

**ユーザーストーリー:** ユーザーとして、記録を継続するモチベーションを維持したいので、通知やアニメーションなどの継続促進機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーが1日記録を忘れる THEN システムは 優しいリマインダー通知を送信する
2. WHEN ユーザーが連続記録を達成する THEN システムは 祝福アニメーションとストリーク表示を提供する
3. WHEN ユーザーがアプリを開く THEN システムは スムーズで魅力的なアニメーションを表示する
4. WHEN ユーザーが目標を設定する THEN システムは 進捗に応じたビジュアルフィードバックを提供する

### 要件5：スマートな目標設定

**ユーザーストーリー:** ユーザーとして、現実的で達成可能な健康目標を設定したいので、AIによる個人化された目標提案機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーの2週間分のデータが蓄積される THEN システムは 個人の傾向に基づいた目標を提案する
2. WHEN ユーザーが目標を設定する THEN システムは 段階的で現実的な目標設定をガイドする
3. WHEN 目標達成率が低い THEN システムは 目標の調整を提案する
4. WHEN 季節や生活パターンが変化する THEN システムは 適応的な目標調整を提案する

### 要件6：健康インサイト

**ユーザーストーリー:** ユーザーとして、単なる数値記録以上の価値を得たいので、健康データから意味のあるインサイトを提供する機能が欲しい

#### 受け入れ基準

1. WHEN 十分なデータが蓄積される THEN システムは 睡眠と体重の相関、活動量と気分の関係などのインサイトを提供する
2. WHEN 異常な数値変動を検出する THEN システムは 注意喚起と改善提案を表示する
3. WHEN 月次レポートを生成する THEN システムは 成果のハイライトと改善点を含む包括的なレポートを提供する
4. WHEN ユーザーが特定のパターンを示す THEN システムは パーソナライズされた健康アドバイスを提供する

### 要件7：ゲーミフィケーション機能

**ユーザーストーリー:** ユーザーとして、継続的な記録を楽しく続けたいので、達成感を得られるゲーミフィケーション機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーが継続記録を達成する THEN システムは SwiftUIの描画機能で作成された美しいバッジを授与する
2. WHEN ユーザーが特定のマイルストーンを達成する THEN システムは 達成レベルに応じた異なるデザインのバッジを提供する
3. WHEN ユーザーがバッジコレクション画面を表示する THEN システムは 獲得済み・未獲得バッジを視覚的に分かりやすく表示する
4. WHEN ユーザーが新しいバッジを獲得する THEN システムは 祝福アニメーションと共にバッジ獲得を通知する
5. WHEN ユーザーがSNS共有する THEN システムは 獲得バッジを含めた共有画像を生成する

### 要件8：AI連携対応ロギング機能

**ユーザーストーリー:** 開発者として、AIコーディングエージェントと効率的に連携したいので、必要十分で構造化されたログ出力機能が欲しい

#### 受け入れ基準

1. WHEN アプリでエラーが発生する THEN システムは エラーの種類、発生箇所、関連コンテキストを構造化してログ出力する
2. WHEN 重要な処理が実行される THEN システムは 処理の開始・終了・結果を簡潔にログ出力する
3. WHEN ログレベルが設定される THEN システムは DEBUG、INFO、WARNING、ERRORレベルに応じて適切な量のログを出力する
4. WHEN AIエージェントがログを解析する THEN システムは JSON形式で構造化されたログを提供する
5. IF 本番環境で動作する THEN システムは 個人情報を含まない安全なログのみを出力する

### 要件9：データセキュリティとプライバシー

**ユーザーストーリー:** ユーザーとして、個人の健康データを安全に管理したいので、強固なセキュリティとプライバシー保護機能が欲しい

#### 受け入れ基準

1. WHEN ユーザーがアプリを使用する THEN システムは すべての健康データを暗号化して保存する
2. WHEN データ同期が必要な場合 THEN システムは エンドツーエンド暗号化を使用する
3. WHEN ユーザーがアカウントを削除する THEN システムは すべての個人データを完全に削除する
4. WHEN 第三者との連携が必要な場合 THEN システムは 明示的な同意なしにデータを共有しない